<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="MauiFirstUartApp.MainPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml">
    <ScrollView>
        <VerticalStackLayout Padding="30,0" Spacing="20">


            <!--  시리얼 타입 선택 라디오 버튼 그룹  -->
            <HorizontalStackLayout Spacing="20">
                <Label Text="시리얼 타입:" VerticalOptions="Center" />
                <RadioButton
                    Content="일반 시리얼"
                    GroupName="SerialType"
                    IsChecked="{Binding SelectedSerialType, Converter={StaticResource SerialTypeToBoolConverter}, ConverterParameter=Normal, Mode=TwoWay}" />
                <RadioButton
                    Content="모드버스"
                    GroupName="SerialType"
                    IsChecked="{Binding SelectedSerialType, Converter={StaticResource SerialTypeToBoolConverter}, ConverterParameter=Modbus, Mode=TwoWay}" />
            </HorizontalStackLayout>

            <VerticalStackLayout IsVisible="{Binding SelectedSerialType, Converter={StaticResource SerialTypeToBoolConverter}, ConverterParameter=Modbus}" Spacing="10">
                <Label FontAttributes="Bold" Text="모드버스 설정" />
                <HorizontalStackLayout Spacing="10">
                    <Label Text="슬레이브 ID:" VerticalOptions="Center" />
                    <Entry
                        Keyboard="Numeric"
                        Text="{Binding ModbusSlaveId, Mode=TwoWay}"
                        WidthRequest="60" />
                    <Label Text="어드레스:" VerticalOptions="Center" />
                    <Entry
                        Keyboard="Numeric"
                        Text="{Binding ModbusAddress, Mode=TwoWay}"
                        WidthRequest="80" />
                    <Label Text="개수:" VerticalOptions="Center" />
                    <Entry
                        Keyboard="Numeric"
                        Text="{Binding ModbusQuantity, Mode=TwoWay}"
                        WidthRequest="60" />
                </HorizontalStackLayout>
                <Button
                    Command="{Binding ModbusReadCommand}"
                    IsEnabled="{Binding IsConnected}"
                    Text="모드버스 읽기" />
                <Button
           Command="{Binding ModbusReadInputCommand}"
           IsEnabled="{Binding IsConnected}"
           Text="모드버스 인풋 읽기" />

                <Button
                    Command="{Binding ModbusWriteCommand}"
                    IsEnabled="{Binding IsConnected}"
                    Text="모드버스 쓰기" />
            </VerticalStackLayout>



            <!--  포트, Baud  -->
            <HorizontalStackLayout Spacing="10">

                <Label Text="포트:" VerticalOptions="Center" />
                <Picker
                    ItemsSource="{Binding PortNames}"
                    SelectedItem="{Binding SelectedPort, Mode=TwoWay}"
                    WidthRequest="120" />
                <Label Text="Baud:" VerticalOptions="Center" />
                <Entry
                    Keyboard="Numeric"
                    Text="{Binding BaudRate, Mode=TwoWay}"
                    WidthRequest="80" />
            </HorizontalStackLayout>
            <HorizontalStackLayout Spacing="10" />

            <!--  DataBits, Parity, StopBits  -->
            <HorizontalStackLayout Spacing="10">
                <Label Text="DataBits:" VerticalOptions="Center" />
                <Entry
                    Keyboard="Numeric"
                    Text="{Binding DataBits, Mode=TwoWay}"
                    WidthRequest="50" />
                <Label Text="Parity:" VerticalOptions="Center" />
                <Picker
                    ItemsSource="{Binding ParityOptions}"
                    SelectedItem="{Binding SelectedParity, Mode=TwoWay}"
                    WidthRequest="80" />
                <Label Text="StopBits:" VerticalOptions="Center" />
                <Picker
                    ItemsSource="{Binding StopBitsOptions}"
                    SelectedItem="{Binding SelectedStopBits, Mode=TwoWay}"
                    WidthRequest="80" />
            </HorizontalStackLayout>

            <!--  연결/해제 버튼  -->
            <HorizontalStackLayout Spacing="10">


                <Button
                    Command="{Binding ConnectCommand}"
                    IsEnabled="{Binding CanConnect}"
                    Text="연결" />
                <Button
                    Command="{Binding DisconnectCommand}"
                    IsEnabled="{Binding CanDisconnect}"
                    Text="해제" />
                <Label Text="{Binding StatusText}" VerticalOptions="Center" />
            </HorizontalStackLayout>

            <!--  송신 영역  -->
            <Label Text="송신 데이터:" />
            <HorizontalStackLayout Spacing="10">
                <Entry
                    Placeholder="데이터 입력"
                    Text="{Binding SendText, Mode=TwoWay}"
                    WidthRequest="250" />
                <Button
                    Command="{Binding SendCommand}"
                    IsEnabled="{Binding CanSend}"
                    Text="전송" />
            </HorizontalStackLayout>

            <!--  수신 영역  -->
            <Label Text="수신 데이터:" />
            <Editor
                HeightRequest="80"
                IsReadOnly="True"
                Text="{Binding ReceivedText}" />

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
